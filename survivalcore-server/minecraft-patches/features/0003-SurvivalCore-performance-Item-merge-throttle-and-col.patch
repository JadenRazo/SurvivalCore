From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: JadenRazo <jadenrazo@yahoo.com>
Date: Thu, 12 Feb 2026 22:07:41 +0000
Subject: [PATCH] SurvivalCore performance: Item merge throttle and collision
 skip


diff --git a/net/minecraft/world/entity/Entity.java b/net/minecraft/world/entity/Entity.java
index 9a102b2c58446bd0aac5bd7f00e647f0270e7983..43166af069ae161e981a1a8d794df858eeea6b06 100644
--- a/net/minecraft/world/entity/Entity.java
+++ b/net/minecraft/world/entity/Entity.java
@@ -1486,6 +1486,12 @@ public abstract class Entity implements SyncedDataHolder, Nameable, EntityAccess
 
     // Paper start - optimise collisions
     private Vec3 collide(Vec3 movement) {
+        // SurvivalCore start - Skip collision for near-stationary entities
+        if (net.survivalcore.config.SurvivalCoreConfig.get().collisionSkipStationary
+            && movement.lengthSqr() < 1.0E-12) {
+            return movement;
+        }
+        // SurvivalCore end
         final boolean xZero = movement.x == 0.0;
         final boolean yZero = movement.y == 0.0;
         final boolean zZero = movement.z == 0.0;
diff --git a/net/minecraft/world/entity/item/ItemEntity.java b/net/minecraft/world/entity/item/ItemEntity.java
index 51804b611f469f2ab53e455e8c633b867b00cc88..ce06e7c1344314465edc0008abb4859d426f964d 100644
--- a/net/minecraft/world/entity/item/ItemEntity.java
+++ b/net/minecraft/world/entity/item/ItemEntity.java
@@ -56,6 +56,7 @@ public class ItemEntity extends Entity implements TraceableEntity {
     public boolean canMobPickup = true; // Paper - Item#canEntityPickup
     private int despawnRate = -1; // Paper - Alternative item-despawn-rate
     public net.kyori.adventure.util.TriState frictionState = net.kyori.adventure.util.TriState.NOT_SET; // Paper - Friction API
+    private int survivalcoreMergeCooldown = 0; // SurvivalCore - Item merge throttle
 
     public ItemEntity(EntityType<? extends ItemEntity> entityType, Level level) {
         super(entityType, level);
@@ -209,7 +210,17 @@ public class ItemEntity extends Entity implements TraceableEntity {
                 || Mth.floor(this.zo) != Mth.floor(this.getZ());
             int i = flag ? 2 : 40;
             if (this.tickCount % i == 0 && !this.level().isClientSide && this.isMergable()) {
-                this.mergeWithNeighbours();
+                // SurvivalCore start - Item merge throttle
+                if (net.survivalcore.config.SurvivalCoreConfig.get().itemMergeThrottleEnabled && this.survivalcoreMergeCooldown > 0) {
+                    this.survivalcoreMergeCooldown--;
+                } else {
+                    int oldCount = this.getItem().getCount();
+                    this.mergeWithNeighbours();
+                    if (net.survivalcore.config.SurvivalCoreConfig.get().itemMergeThrottleEnabled && this.getItem().getCount() == oldCount) {
+                        this.survivalcoreMergeCooldown = net.survivalcore.config.SurvivalCoreConfig.get().itemMergeCooldownTicks;
+                    }
+                }
+                // SurvivalCore end
             }
 
             if (this.age != -32768) {
